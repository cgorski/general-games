{-# LANGUAGE MultiParamTypeClasses #-}

module Game.Implement.Card.Standard.Poker
  where

import Game.Implement.Card
import Game.Implement.Card.Standard

data Order = AceHighRankOrder | AceLowRankOrder | SuitOrder deriving (Eq)
data ValueType = RankValueType | SuitValueType

instance OrderedCard PlayingCard Order where
  compareCardBy AceHighRankOrder (PlayingCard Ace _) (PlayingCard _ _) = LT
  compareCardBy AceHighRankOrder (PlayingCard _ _) (PlayingCard Ace _) = GT
  compareCardBy AceHighRankOrder (PlayingCard r1 _) (PlayingCard r2 _) =
    if r1 == r2
    then EQ
    else r2 `compare` r1

  compareCardBy AceLowRankOrder (PlayingCard Ace _) (PlayingCard _ _) = GT
  compareCardBy AceLowRankOrder (PlayingCard _ _) (PlayingCard Ace _) = LT
  compareCardBy AceLowRankOrder (PlayingCard r1 _) (PlayingCard r2 _) =
    if r1 == r2
    then EQ
    else r2 `compare` r1
    
  compareCardBy SuitOrder (PlayingCard _ s1) (PlayingCard _ s2) = s1 `compare` s2


instance OrderedValuedCard PlayingCard Order ValueType where
  toOrderedValue AceLowRankOrder RankValueType (PlayingCard Ace _) = 0
  toOrderedValue AceLowRankOrder RankValueType (PlayingCard r _) = (fromEnum r) + 1
  toOrderedValue AceHighRankOrder RankValueType (PlayingCard Ace _) = 14
  toOrderedValue SuitOrder SuitValueType (PlayingCard _ s) = fromEnum s


rankOfOrderedValue :: AceRank -> Int -> Rank
rankOfOrderedValue AceHigh n = toEnum n
rankOfOrderedValue AceLow n = toEnum $ (n-1)

rankOfBothAces :: Int -> Rank
rankOfBothAces n = fromEnum (n `mod` 13)


  
